<% if(session) { %>
<%- include('template/!head.ejs') %>

<body class="sb-nav-fixed">
<%- include('template/navbar.ejs') %>

	<div id="layoutSidenav">
	<%- include('template/sidebar.ejs') %>

		<div id="layoutSidenav_content">
			<div>
				<input type="hidden" id="input_name" value="<%= session.name %>">
			</div>

			<div class="mb-3">
				<div class="container-fluid px-4">
					<div class="container">
						<div class="dynamic-title mt-4 mb-0 vw-80 vw-lg-50">
							<h1 class="display-3 text-center pt-3 pb-5">
								<span class="lang" data-lang="es">Métricas</span><span class="lang" data-lang="en">Metrics</span>
							</h1>
						</div>
					</div>
				</div>
			</div>

			<div class="mb-5 bg-ligth-gray">
				<div class="row w-100 w-lg-90 my-3">
					<div class="w-auto d-flex ms-2 me-lg-5 ms-lg-4 pe-lg-5">
						<h2 class="display-6 text-center my-auto">
							<span class="lang" data-lang="es">Controles</span>
							<span class="lang" data-lang="en">Controls</span>
						</h2>
					</div>
					<div class="col">
						<div class="d-flex justify-content-end my-4 pe-5">
							<button id="btn-mono-report" class="btn btn-download text-center d-flex flex-column mx-3">
								<span class="w-100">
									<i class="fa-solid fa-file-download fa-3x"></i>
								</span>
								<span class="w-100 mt-2">
									<span class="lang" data-lang="es">Descargar Reporte</span>
									<span class="lang" data-lang="en">Download Report</span>
								</span>
							</button>
							<button id="btn-all-report" class="btn btn-download text-center d-flex flex-column mx-3">
								<span class="w-100">
									<i class="fa-solid fa-file-download fa-3x"></i>
								</span>
								<span class="w-100 mt-2">
									<span class="lang" data-lang="es">Descargar Todo</span>
									<span class="lang" data-lang="en">Download All</span>
								</span>
							</button>
							<button id="addPanel" class="btn btn-add-panel text-center d-flex flex-column mx-3">
								<span class="w-100">
									<i class="fa-solid fa-plus fa-3x"></i>
								</span>
								<span class="w-100 mt-2">
									<span class="lang" data-lang="es">Agregar panel</span>
									<span class="lang" data-lang="en">Add Panel</span>
								</span>
							</button>
						</div>
					</div>
				</div>
			</div>

			<div id="yea">
				<% for(let s in subordinates) { %>
					<%= subordinates[s].description%>
				<% } %>
			</div>
			
			<div>
				<div class="container-fluid px-4">
					<div class="help-bar bg-dark text-light w-100 rounded-3">
						<div class="d-flex justify-content-center">
							<div class="w-80 w-md-50 text-center d-inline-flex my-2">
								<i class="fa-solid ms-auto me-2 my-auto fa-info-circle fa-2x blink"></i>
								<p class="fs-5 me-auto ms-2 my-2">
									<span class="lang" data-lang="es">
										<span class="fw-bold me-1">Pequeño tip:</span> Si deseas comparar áreas y demás,
										basta con solo agregar un nuevo panel y configurar lo que quieres ver. ¡Sencillísimo!
									</span>
									<span class="lang" data-lang="en">
										<span class="fw-bold me-1">Little tip:</span> If you want to compare areas and so on, 
										just add a new panel and configure what you want to see. Very simple!
									</span>
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>


			<div class="mb-5">
				<div class="container-fluid px-4">
					<% if(false) { /* - Bar chart - */ %>
					<div class="row w-100 my-4">
						<div class="row mx-auto w-100 w-md-75 w-lg-50 my-3">
							<div class="col-md-6 col-5">
								<p class="text-justyfied m-0 d-flex h-100">
									<span class="text-wrap align-self-center m-0 p-0" data-lang="es">Elige lo que quieres ver en la tabla</span>
									<span class="text-wrap align-self-center m-0 p-0" data-lang="en">Select what yo want to display in the chart</span>
								</p>
							</div>
							
							<div class="col-md-6 col-7">
								<select class="form-select" id="sel-bar-chart" name="sel-bar-chart">
									<option class="barSelect lang" value="0" data-lang="es" selected>Áreas</option>
									<option class="barSelect lang" value="0" data-lang="en" selected>Areas</option>

									<option class="barSelect lang" value="1" data-lang="es">Direcciones / Subdirecciones</option>
									<option class="barSelect lang" value="1" data-lang="en">Directions / Sub-directions</option>
								</select>
							</div>
						</div>

						<div id="bars" class="row mx-3">
							<canvas width="75%" height="30%"></canvas>
						</div>
					</div>
					<% } %>

					<div id="panelContainer" class="row m-0 my-4 mx-auto justify-content-center"> <!-- Row div container for the report panels -->
						<div class="col-12 col-md-6 col-xxl-4 panel my-3" data-id="0">
							<div class="shadow-lg rounded-2 buttons-container">
								<div class="row justify-content-end">
									<div class="config-menu d-none position-absolute w-md-30 w-40 rounded-2 shadow-lg py-3 mt-6 me-5">
										<div class="container m-0 p-0">
											<div class="row">
												<div class="col-md-6 col-12 mx-auto my-1">
													<div class="form-floating">
														<select class="form-select area" id="sel-area" name="sel-area" aria-label="Selección">
															<option class="area-def" value="0" data-lang="es" selected>Personal a cargo</option>
															<option class="area-def" value="0" data-lang="en" selected>Personnel in charge</option>
															<% for(let a in areas) { %>
																<option class="area" value="<%= areas[a]['_id'] %>"> 
																	<%= areas[a]['description'][session.lang] %> 
																</option>
															<% } %>
														</select>
														<label for="sel-area">
															<span class="lang" data-lang="es">Área</span>
															<span class="lang" data-lang="en">Area</span>
														</label>
													</div>
												</div>
												<div class="col-md-6 col-12 mx-auto my-1">
													<div class="form-floating">
														<select class="form-select direction" id="sel-direction" name="sel-direction" aria-label="Selección">
															<option class="direction-def" value="0" selected data-lang="es">-Selecciona dirección-</option>
															<option class="direction-def" value="0" selected data-lang="en">-Select direction-</option>
															<% for(let d in directions) { %>
																<option class="direction" value="<%= directions[d]['_id'] %>">
																	<%= directions[d]['description'][session.lang] %>
																</option>
															<% } %>
														</select>
														<label for="sel-direction">
															<span class="lang" data-lang="es">Dirección</span>
															<span class="lang" data-lang="en">Direction</span>
														</label>
													</div>
												</div>
												<div class="col-md-6 col-12 mx-auto my-1">
													<div class="form-floating">
														<select class="form-select subordinates" id="sel-subordinates" name="sel-subordinates"
															aria-label="Selección">
															<option class="sub-def" value="0" selected data-lang="es">-Selecciona personal-</option>
															<option class="sub-def" value="0" selected data-lang="en">-Select personnel-</option>
															<% for(let s in subordinates) { %>
																<option class="sub" data-index="<%= parseInt(s)+1 %>" value="<%= subordinates[s]['_id'] %>"> 
																	<%= subordinates[s].position.description[session.lang] %>
																</option>
															<% } %>
														</select>
														<label for="sel-subordinates">
															<span class="lang" data-lang="es">Personal</span>
															<span class="lang" data-lang="en">Personnel</span>
														</label>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="row px-md-2 px-xl-4 pb-3">
									<div class="col-12 px-md-2 px-xl-4">
										<div class="lienzos container">
											<div class="row">
												<div class="col-2 col-md-1 p-0 m-0">
													<button class="btn canvas-remove m-0 ms-5 mt-4 p-1 w-auto position-absolute">
														<i class="fa-solid fa-times fa-2x pointer-event-none mx-1"></i>
													</button>
												</div>
												
												<div class="col-8 col-md-10 mt-4">
													<h5 class="text-center fs-4 text-uppercase canvasTitle lang" data-lang="es"">
														Personal a cargo
													</h5>
													<h5 class="text-center fs-4 text-uppercase canvasTitle lang" data-lang="en">
														Personnel
													</h5>
												</div>

												<div class="col-2 col-md-1 p-0 m-0">
													<button class="btn canvas-config mt-4 tooltip-text rot-20"
														data-tooltip-es="Desplegar opciones para este panel">
														<i class="fa-solid fa-cog fa-2x pointer-event-none"></i>
													</button>
												</div>
											</div>
											<div class="row canvas-container semiDoughnutChart">
												<canvas width="100%" height="100%"></canvas>
											</div>
											<div class="row canvas-container lineChart">
												<canvas width="100%" height="50%"></canvas>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<%- include('template/!scripts.ejs') %>
	<script src="/js/metrics.js"></script>
</body>

</html>
<% } else { %>
	<%- include('template/!handler.ejs') %>
<% } %>